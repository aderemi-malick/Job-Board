<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API des Personnes</title>
    <script >
        const apiUrl = "http://127.0.0.1:8000"; // Remplacez par l'URL de votre API si nécessaire

        // Fonction pour récupérer toutes les personnes
        async function fetchCompanies() {
            event.preventDefault(); 
            const response = await fetch(`${apiUrl}/companies`);
            const data = await response.json();
            const list = document.getElementById("personList");
            console.log(data)
            data.forEach(row => {
                const item = document.createElement("div");
                item.innerHTML = `<h2>${row.name}</h2>`;
                list.appendChild(item);
                list.style.display ="flex";
                list.style.flexWrap = "wrap";
                list.style.alignItems = "center"
                list.style.justifyContent ="space-around";
                item.style.margin = "12px" ;
                item.style.width = "120px" ;
                item.style.borderBlock = "0.49vw solid #a01a";
                
                console.log(row)
            }); // Réinitialise la liste

        }
            // data.forEach(companie => {
            //     const item = document.createElement("li");
            //     item.textContent = companie; // Affiche chaque personne
            //     list.appendChild(item);
            // });


            /* if (Array.isArray(data)) { 
                console.log("JSON")
                data.forEach(companie => {
                const item = document.createElement("li");
                // Assurez-vous que les propriétés existent dans chaque objet
                item.textContent = companie; // Affiche le nom et la description de chaque entreprise
                list.appendChild(item);
                    });
            } else {
                console.error("Les données retournées ne sont pas un tableau");
            } 

        }

        // Fonction pour créer une nouvelle personne
        async function createPerson(event) {
            event.preventDefault(); // Empêche le rechargement de la page

            const firstName = document.getElementById("firstName").value;
            const lastName = document.getElementById("lastName").value;

            const response = await fetch(`${apiUrl}/person`, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({ first_name: firstName, last_name: lastName }),
            });

            if (response.ok) {
                alert("Personne créée avec succès !");
                fetchPersons(); // Rafraîchit la liste des personnes
                document.getElementById("personForm").reset(); // Réinitialise le formulaire
            } else {
                alert("Erreur lors de la création de la personne.");
            }
        }*/

        // Appelle la fonction pour récupérer les personnes lors du chargement de la page
        //window.onload = fetchCompanies; 
    </script>
</head>
<body>
    <h1>API des Personnes</h1>

    <h2>Créer une nouvelle personne</h2>
    <form id="personForm" onsubmit="fetchCompanies()">
        <input type="text" id="firstName" placeholder="Prénom" >
        <input type="text" id="lastName" placeholder="Nom de famille">
        <button type="submit">Ajouter</button>
    </form>

    <h2>Liste des personnes</h2>
    <div id="personList"></div>
</body>
</html>
